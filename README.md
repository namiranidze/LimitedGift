# ლიმიტირებული საჩუქარი
# აღწერა

 იმისათვის, რომ მედიცინში გაცემული რაოდენობებიც იყოს გათვალისწინებული, აქციის ამოქმედებისას მედიცინიდან უნდა მოხდეს  ERP სერვისების გამოძახება და გამოიგზავნოს საჩუქრის შესახებ ინფორმაცია.  საჭირო იქნება ორი სერვისის გამოძახება: 
მედიცინში აქციის ამოქმედებამდე უნდა მოხდეს ERP სერვისის გამოძახება(CheckDiscountLimit). გამოიგზავნოს ფასდაკლების იდენტიფიკატორი, რომლის საფუძველზეც ERP დააბრუნებს იმ მომენტისთვის გაცემული საჩუქრების რაოდენობას. მედიცინში აქციის სხვა პირობებთან ერთად უნდა გადამოწმდეს მიღებული რაოდენობა აღემატება თუ არა დადგენილ ლიმიტს და ამის მიხედვით გაიცეს საჩუქარი.  
მედიცინში საჩუქრის გაცემის შემთხვევაში, უნდა მოხდეს ERP სერვისის გამოძახება და მედიცინმა გადმოგვცეს გაცემული საჩუქრის შესახებ ინფორმაცია.(SaveDiscountLimit)


## მეთოდები

- CheckDiscountLimit - GET
- SaveDiscountLimit - POST

## CheckDiscountLimit

ავტორიზაცია :Basic Auth - გადმოეცემა 1С იუზერი და პაროლი 
გადმოსაცემი პარამეტრები - DiscountUID (ფასდაკლების იდენტიფიკატორი რომელიც ემთხვევა 1c ფასდაკლების იდენტიფიკატორს)

URL შაბლონი
phpos1.aversi.ge:8080/PosTest/hs/PharmacyExchange/CheckDiscountLimit?DiscountUID=test

დაბრუნებული პასუხი:
{
    "Success": true,
    "TotalLimit": 20,
    "UsedLimit": 15,
    "ResultMessage": ""
}

## SaveDiscountLimit

ავტორიზაცია :Basic Auth - გადმოეცემა 1С იუზერი და პაროლი 
გადმოსაცემი პარამეტრები:
DiscountUID - ფასდაკლების იდენტიფიკატორი რომელიც ემთხვევა 1c ფასდაკლების იდენტიფიკატორს
Date - ჩეკის თარიღი
NUM_ZED - ჩეკის ნომერი
COD_AVE - აფთიაქის კოდი
MAT_COD - მედიკამენტის კოდი
Quantity - საჩუქრად გაცემული რაოდენობა

URL შაბლონი
phpos1.aversi.ge:8080/PosTest/hs/PharmacyExchange/SaveDiscountLimit

Json Body
{
    "DiscountUID": "test",
    "Date": "2024-10-31T00:00:00",
    "NUM_ZED": 123,
    "COD_AVE": 3800,
    "MAT_COD": 71,
    "Quantity": 1
}

დაბრუნებული პასუხი:
{
    "Success": true,
    "ResultMessage": ""
}
